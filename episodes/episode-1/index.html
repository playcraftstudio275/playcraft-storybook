<!DOCTYPE html>
<html>
<head>
  <title>Episode 1 - Playcraft Storybook</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #000;
    }

    body {
      min-height: 100svh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .book {
      width: 100%;
      max-width: 900px;
      height: 100svh;
      display: flex;
      flex-direction: column;
      padding: 15px;
    }

    .page {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .spread {
      display: flex;
      width: 100%;
      height: 100%;
    }

    .spread img {
      height: 100%;
      object-fit: contain;
    }

    .left {
      width: 50%;
    }

    .right {
      width: 50%;
    }

    .cover img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .controls {
      text-align: center;
      padding: 10px 0;
    }

    button {
      padding: 10px 20px;
      margin: 5px;
      border: none;
      border-radius: 25px;
      background: #ff9800;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }

    button:active {
      transform: scale(0.95);
    }

  </style>
</head>

<body>

<div class="book">

  <div class="page" id="pageContainer"></div>

  <div class="controls">
    <button onclick="prevPage()">◀</button>
    <button onclick="nextPage()">▶</button>
    <button onclick="goHome()">Home</button>
  </div>

</div>

<audio id="pageSound" src="../../assets/audio/page-flip.mp3"></audio>

<script>

  let currentIndex = 0;

  const pageContainer = document.getElementById("pageContainer");
  const pageSound = document.getElementById("pageSound");

  const totalSpreads = 9; // 1–9

  function renderPage() {

    pageContainer.innerHTML = "";

    // COVER
    if (currentIndex === 0) {
      const coverDiv = document.createElement("div");
      coverDiv.className = "cover";

      const img = document.createElement("img");
      img.src = "images/0.jpg";

      coverDiv.appendChild(img);
      pageContainer.appendChild(coverDiv);
      return;
    }

    // SPREAD
    const spreadDiv = document.createElement("div");
    spreadDiv.className = "spread";

    const leftImg = document.createElement("img");
    leftImg.className = "left";
    leftImg.src = `images/${currentIndex}a.jpg`;

    const rightImg = document.createElement("img");
    rightImg.className = "right";
    rightImg.src = `images/${currentIndex}b.jpg`;

    spreadDiv.appendChild(leftImg);
    spreadDiv.appendChild(rightImg);

    pageContainer.appendChild(spreadDiv);
  }

  function nextPage() {
    if (currentIndex < totalSpreads) {
      currentIndex++;
      pageSound.currentTime = 0;
      pageSound.play();
      renderPage();
    }
  }

  function prevPage() {
    if (currentIndex > 0) {
      currentIndex--;
      pageSound.currentTime = 0;
      pageSound.play();
      renderPage();
    }
  }

  function goHome() {
    window.location.href = "../../index.html";
  }

  // Swipe support
  let startX = 0;

  document.body.addEventListener("touchstart", e => {
    startX = e.touches[0].clientX;
  });

  document.body.addEventListener("touchend", e => {
    let endX = e.changedTouches[0].clientX;
    if (startX - endX > 50) nextPage();
    if (endX - startX > 50) prevPage();
  });

  renderPage();

</script>

</body>
</html>
