<!DOCTYPE html>
<html>
<head>
  <title>Episode 1 - Playcraft Storybook</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }

    html, body {
      height:100%;
      background:#000;
      overflow:hidden;
      font-family:Arial, sans-serif;
    }

    body {
      display:flex;
      justify-content:center;
      align-items:center;
    }

    .book {
      width:100%;
      max-width:600px;
      height:95vh;
      background:rgba(0,0,0,0.6);
      border-radius:20px;
      padding:15px;
      display:flex;
      flex-direction:column;
      backdrop-filter:blur(10px);
    }

    .progress {
      height:5px;
      background:rgba(255,255,255,0.2);
      border-radius:5px;
      margin-bottom:10px;
      overflow:hidden;
    }

    .progress-bar {
      height:100%;
      width:0%;
      background:#ff9800;
      transition:width .4s ease;
    }

    .stage {
      flex:1;
      position:relative;
      perspective:2500px;
      overflow:hidden;
    }

    .page-layer {
      position:absolute;
      width:100%;
      height:100%;
      top:0;
      left:0;
      display:flex;
      justify-content:center;
      align-items:center;
    }

    .spread {
      width:100%;
      height:100%;
      display:flex;
    }

    .spread img {
      width:50%;
      height:100%;
      object-fit:contain;
    }

    .cover img {
      width:100%;
      height:100%;
      object-fit:contain;
    }

    .flip {
      transform-origin:left center;
      transform-style:preserve-3d;
      z-index:5;
    }

    .flipping {
      animation:flipBook .8s ease forwards;
    }

    @keyframes flipBook {
      0% { transform:rotateY(0deg); }
      100% { transform:rotateY(-180deg); }
    }

    .controls {
      text-align:center;
      margin-top:10px;
    }

    button {
      padding:10px 18px;
      margin:5px;
      border:none;
      border-radius:25px;
      background:#ff9800;
      color:white;
      font-size:14px;
      cursor:pointer;
    }

    #intro {
      position:fixed;
      width:100%;
      height:100%;
      background:black;
      display:flex;
      justify-content:center;
      align-items:center;
      z-index:9999;
      animation:fadeOut 3s forwards;
    }

    @keyframes fadeOut {
      0% { opacity:1; }
      80% { opacity:1; }
      100% { opacity:0; visibility:hidden; }
    }

    .logo {
      color:white;
      font-size:28px;
      letter-spacing:4px;
    }

  </style>
</head>

<body>

<div id="intro">
  <div class="logo">PLAYCRAFT STUDIO</div>
</div>

<div class="book">

  <div class="progress">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <div class="stage">
    <div id="staticLayer" class="page-layer"></div>
    <div id="flipLayer" class="page-layer flip"></div>
  </div>

  <div class="controls">
    <button onclick="prevPage()">◀</button>
    <button onclick="nextPage()">▶</button>
    <button onclick="goHome()">Home</button>
  </div>

</div>

<audio id="pageSound" src="../../assets/audio/page-flip.mp3"></audio>

<script>

let current = 0;
const total = 9;

const staticLayer = document.getElementById("staticLayer");
const flipLayer = document.getElementById("flipLayer");
const progressBar = document.getElementById("progressBar");
const pageSound = document.getElementById("pageSound");

function renderPage() {

  staticLayer.innerHTML = "";

  if (current === 0) {
    const cover = document.createElement("div");
    cover.className = "cover";
    cover.innerHTML = `<img src="images/0.jpg">`;
    staticLayer.appendChild(cover);
  } else {
    const spread = document.createElement("div");
    spread.className = "spread";
    spread.innerHTML = `
      <img src="images/${current}a.jpg">
      <img src="images/${current}b.jpg">
    `;
    staticLayer.appendChild(spread);
  }

  progressBar.style.width = (current / total) * 100 + "%";
}

function nextPage() {
  if (current >= total) return;

  flipLayer.innerHTML = staticLayer.innerHTML;
  flipLayer.classList.add("flipping");

  pageSound.currentTime = 0;
  pageSound.play();

  setTimeout(() => {
    current++;
    renderPage();
    flipLayer.classList.remove("flipping");
    flipLayer.innerHTML = "";
  }, 800);
}

function prevPage() {
  if (current <= 0) return;

  current--;
  renderPage();
}

function goHome() {
  window.location.href = "../../index.html";
}

renderPage();

</script>

</body>
</html>
